<h2>HTTP Requests</h2>

<script>
  // const request = new XMLHttpRequest()

  // request.addEventListener('readystatechange', (e) => {
  //   if (e.target.readyState === 4 && e.target.status === 200) {
  //     const data = JSON.parse(e.target.responseText)
  //     console.log(data)
  //   } else if (e.target.readyState === 4) {
  //     console.log('Error 400')
  //   }
  // })
  // request.open('GET', 'https://puzzle.mead.io/puzzle?wordCountt=2')
  // request.send()

  //using callbacks - async
  const getPuzzle = (callback) => {
    const request = new XMLHttpRequest()

    request.addEventListener('readystatechange', (e) => {
      if (e.target.readyState === 4 && e.target.status === 200) {
        const data = JSON.parse(e.target.responseText)
        callback(undefined, data)
      } else if (e.target.readyState === 4) {
        callback('Error 400', undefined)
      }
    })
    request.open('GET', 'https://puzzle.mead.io/puzzle?wordCount=2')
    request.send()
  }

  // getPuzzle((error, puzzle) => {
  //   if (error) {
  //     console.log(error)
  //   }
  //   console.log(puzzle)
  // })

  //sychronous call
  const getPuzzleSync = (callback) => {
    const request = new XMLHttpRequest()

    request.open('GET', 'https://puzzle.mead.io/puzzle?wordCount=2', false)
    request.send()

    if (request.readyState === 4 && request.status === 200) {
      const data = JSON.parse(request.responseText)
      return data
    } else if (request.readyState === 4) {
      throw new Error('Some error occured')
    }
  }

  const puzzle = getPuzzleSync()
  console.log(puzzle)

  console.log('Do Something else')
</script>
